<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
    <title>Quartz PocketWatch</title>
	<link type="text/css" href="Contents/css/dark-hive/jquery-ui-1.8.21.custom.css" rel="stylesheet" />
    <style type="text/css">
            .check 
            {
                background-image: url(Contents/images/Check.png);
                width: 32px;
                height: 32px;
            }
            
            .showElement
            {
                visibility: hidden;
            }
            
            body  
            {
                background: #1c1a1c; 
                color: #ffffff; 
                font-family: Verdana;
            }

    </style>
    <script src="Contents/js/jquery-1.7.2.min.js" type="text/javascript"></script>
	<script src="Contents/js/jquery-ui-1.8.21.custom.min.js" type="text/javascript"></script>
    <script src="Contents/js/knockout-2.1.0.js" type="text/javascript"></script>
</head>
<body>
    <div>
        <br />
	    <div id="tabs">
	 
		    <ul data-bind="template: { name: 'jobTab-template', foreach: JobGroups}"></ul>
		    <div data-bind="template: { name: 'jobPane-template', foreach: JobGroups}"></div>
	    </div>
    </div>

    <script type="text/html" id="jobTab-template" >
        <li><a data-bind="attr: {href: '#' + GroupName }, text: GroupName"></a></li>
    </script>
	
    <script type="text/html" id="jobPane-template" >
        <div data-bind="attr: {id: GroupName}">
        <table>
          <thead>
            <th>Job Name</th>
            <th>Description</th>
            <th>Concurrent</th>
            <th>JobType</th>
            <th>Execute Job</th>
          </thead>
          <tbody data-bind="template: { name: 'jobRow-template', foreach: Jobs}" >
          </tbody>
        </table>
        </div>
    </script>

    <script type="text/html" id="jobRow-template" >
      <tr>
        <td data-bind="text: JobName" ></td>
        <td data-bind="text: Description" ></td>
        <td align="center" ><div class="check" data-bind="css: {check: ConcurrentExecutionAllowed}"></div></td>
        <td data-bind="text: JobType" ></td>
        <td><a href="#">Execute</a> </td>
      </tr>
    </script>


	<script type="text/javascript">
	    var viewModel;
	    //	    var reloadCount = 0;
	    var jobDataUrl = "/json/syncreply/Scheduler";

	    $(document).ready(function () { setInterval(reloadData, 2000); });
	    $(document).ready(loadData);

	    function loadData() {
	        $.getJSON(jobDataUrl, function (data) {
	            viewModel = { JobGroups: ko.observable(data.JobGroups) };
	            ko.applyBindings(viewModel);
	            $("#tabs").tabs();
	        });
	    }

	    function reloadData() {
	        //find job2 and rename

	        //	        $.getJSON(jobDataUrl, function (data) {
	        //	            ko.mapping.fromJS(data, viewModel); reloadCount++;
	        //	        });
	    }

	    ko.applyBindings(viewModel);
	
	</script>	
</body>
</html>